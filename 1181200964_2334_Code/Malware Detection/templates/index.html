<!DOCTYPE html>
<html>
  <head>
    <title>Malware Detection</title>
	<style>
		html,
		body {
			min-height: 100%;
			margin: 0;
			font-family: Arial, sans-serif;
		}

		body {
			padding: 30px;
			/*background-image: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);*/
			box-sizing: border-box;
			background-image: url('/static/3383078.jpg');
			background-size: 100%;
		}

		select {
			-webkit-appearance: none;
				-moz-appearance: none;
					appearance: none;
			background-color: transparent;
			border: none;
			padding: 0 1em 0 0;
			margin: 0;
			width: 100%;
			font-size: 16px;
			cursor: inherit;
			line-height: inherit;
			z-index: 1;
			outline: none;
			overflow: hidden;
		}

		select::-ms-expand {
			display: none;
		}

		.select {
			position: relative;
			min-width: 15ch;
			max-width: 100%;
			border: 1px solid var(--select-border);
			cursor: pointer;
			line-height: 1.1;
			background: #fff;
		}

		.select select, .select::after {
			grid-area: select;
		}

		.select:not(.select--multiple)::after {
			content: "";
			justify-self: end;
			width: 0.8em;
			height: 0.5em;
			background-color: var(--select-arrow);
			-webkit-clip-path: polygon(100% 0%, 0 0%, 50% 100%);
					clip-path: polygon(100% 0%, 0 0%, 50% 100%);
		}

		select:focus + .focus {
			position: absolute;
			top: -1px;
			left: -1px;
			right: -1px;
			bottom: -1px;
			border: 2px solid var(--select-focus);
			border-radius: inherit;
		}

		select[multiple] {
			padding-right: 0;
			/*
			* Safari will not reveal an option
			* unless the select height has room to 
			* show all of it
			* Firefox and Chrome allow showing 
			* a partial option
			*/
			height: 227px;
			/* 
			* Experimental - styling of selected options
			* in the multiselect
			* Not supported crossbrowser
			*/
		}

		select[multiple] option {
			white-space: normal;
			outline-color: var(--select-focus);
			padding: 9px 10px;
		}

		.preview_button {
			height: 36px;
			width: 240px;
			text-align: center;
			text-transform: uppercase;
			transition: 0.5s;
			background-size: 200% auto;
			color: white;
			border-radius: 5px;
			display: block;
			border: 0px;
			font-weight: 700;
			box-shadow: 0px 0px 14px -7px #5DADE2;
			background-image: linear-gradient(45deg, #2988F3 0%, #5DADE2  51%, #2988F3  100%);
			cursor: pointer;
			user-select: none;
			-webkit-user-select: none;
			touch-action: manipulation;
		}

		.preview_button:hover {
			background-position: right center;
			/* change the direction of the change here */
			color: #fff;
			text-decoration: none;
		}

		.preview_button:active {
			transform: scale(0.95);
		}

		.result_button {
			height: 36px;
			width: 240px;
			text-align: center;
			text-transform: uppercase;
			transition: 0.5s;
			background-size: 200% auto;
			color: white;
			border-radius: 5px;
			display: block;
			border: 0px;
			font-weight: 700;
			box-shadow: 0px 0px 14px -7px #f09819;
			background-image: linear-gradient(45deg, #FF512F 0%, #F09819  51%, #FF512F  100%);
			cursor: pointer;
			user-select: none;
			-webkit-user-select: none;
			touch-action: manipulation;
		}

		.result_button:hover {
			background-position: right center;
			/* change the direction of the change here */
			color: #fff;
			text-decoration: none;
		}

		.result_button:active {
			transform: scale(0.95);
		}
	</style>
    <script>
      // Define the data
      var apt1Data = [
        [
			{"file_access": 1798, "pe_imports": 1392, "sig_clamav": 560, "pe_sec_character": 81, "sig_antivirus_virustotal": 2062, "cmd_exec": 541, "api_resolv": 593, 
			"pe_sec_entropy": 1998, "pe_sec_name": 211, "sig_packer_entropy": 557, "mutex_access": 266, "file_read": 1704, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 493, "str": 1441, "reg_read": 121, "reg_write": 15, "sig_injection_runpe": 167, 
			"reg_access": 139, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 66, "file_delete": 456, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 176, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
        [
			{"file_access": 1821, "pe_imports": 323, "sig_clamav": 560, "pe_sec_character": 81, "sig_antivirus_virustotal": 1566, "cmd_exec": 276, "api_resolv": 962, 
			"pe_sec_entropy": 344, "pe_sec_name": 211, "sig_packer_entropy": 557, "mutex_access": 153, "file_read": 1764, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 81, "file_drop": 382, "file_write": 295, "str": 1225, "reg_read": 825, "reg_write": 371, "sig_injection_runpe": 167, 
			"reg_access": 865, "sig_persistence_autorun": 208, "sig_reads_self": 570, "reg_delete": 58, "file_delete": 456, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 127, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 1916, "pe_imports": 1566, "sig_clamav": 560, "pe_sec_character": 99, "sig_antivirus_virustotal": 2036, "cmd_exec": 541, "api_resolv": 621, 
			"pe_sec_entropy": 2037, "pe_sec_name": 226, "sig_packer_entropy": 557, "mutex_access": 133, "file_read": 1819, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 493, "str": 1755, "reg_read": 125, "reg_write": 356, 
			"sig_injection_runpe": 167, "reg_access": 1075, "sig_persistence_autorun": 158, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 456, 
			"sig_stealth_file": 161, "sig_antisandbox_sleep": 129, "net_dns": 97, "net_con": 68, "sig_static_detection": 231}
		],
		[
			{"file_access": 659, "pe_imports": 129, "sig_clamav": 560, "pe_sec_character": 81, "sig_antivirus_virustotal": 2095, "cmd_exec": 112, "api_resolv": 1302, 
			"pe_sec_entropy": 1150, "pe_sec_name": 211, "sig_packer_entropy": 557, "mutex_access": 234, "file_read": 1969, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 561, "str": 1577, "reg_read": 780, "reg_write": 51, "sig_injection_runpe": 167, 
			"reg_access": 845, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 13, "file_delete": 163, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 69, "sig_static_detection": 231}
		],
		[
			{"file_access": 1801, "pe_imports": 600, "sig_clamav": 560, "pe_sec_character": 86, "sig_antivirus_virustotal": 2749, "cmd_exec": 226, "api_resolv": 1173, 
			"pe_sec_entropy": 414, "pe_sec_name": 215, "sig_packer_entropy": 557, "mutex_access": 243, "file_read": 1703, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 561, "str": 1844, "reg_read": 154, "reg_write": 137, "sig_injection_runpe": 167, 
			"reg_access": 970, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 26, "file_delete": 263, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		]
      ];
      
      var cryptoData = [
        [
			{"file_access": 1695, "pe_imports": 1397, "sig_clamav": 560, "pe_sec_character": 39, "sig_antivirus_virustotal": 2018, "cmd_exec": 541, "api_resolv": 837, 
			"pe_sec_entropy": 1888, "pe_sec_name": 10, "sig_packer_entropy": 137, "mutex_access": 364, "file_read": 1562, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 571, "file_write": 526, "str": 11, "reg_read": 425, "reg_write": 234, "sig_injection_runpe": 167, 
			"reg_access": 693, "sig_persistence_autorun": 57, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 500, "sig_stealth_file": 167, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
        [
			{"file_access": 1680, "pe_imports": 399, "sig_clamav": 560, "pe_sec_character": 39, "sig_antivirus_virustotal": 1686, "cmd_exec": 541, "api_resolv": 828, 
			"pe_sec_entropy": 1873, "pe_sec_name": 245, "sig_packer_entropy": 725, "mutex_access": 364, "file_read": 1535, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 456, "file_write": 526, "str": 567, "reg_read": 425, "reg_write": 234, "sig_injection_runpe": 167, 
			"reg_access": 693, "sig_persistence_autorun": 57, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 500, "sig_stealth_file": 167, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 2093, "pe_imports": 1135, "sig_clamav": 560, "pe_sec_character": 77, "sig_antivirus_virustotal": 452, "cmd_exec": 541, "api_resolv": 693, 
			"pe_sec_entropy": 477, "pe_sec_name": 207, "sig_packer_entropy": 557, "mutex_access": 266, "file_read": 1992, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 85, "file_write": 359, "str": 2222, "reg_read": 455, "reg_write": 489, "sig_injection_runpe": 167, 
			"reg_access": 704, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 456, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 2093, "pe_imports": 1135, "sig_clamav": 560, "pe_sec_character": 77, "sig_antivirus_virustotal": 452, "cmd_exec": 541, "api_resolv": 693, 
			"pe_sec_entropy": 477, "pe_sec_name": 207, "sig_packer_entropy": 557, "mutex_access": 266, "file_read": 1992, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 85, "file_write": 359, "str": 2222, "reg_read": 455, "reg_write": 489, "sig_injection_runpe": 167, 
			"reg_access": 704, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 456, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 731, "pe_imports": 652, "sig_clamav": 560, "pe_sec_character": 112, "sig_antivirus_virustotal": 1555, "cmd_exec": 356, "api_resolv": 1102, 
			"pe_sec_entropy": 2190, "pe_sec_name": 348, "sig_packer_entropy": 363, "mutex_access": 160, "file_read": 623, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 167, "file_drop": 516, "file_write": 337, "str": 2598, "reg_read": 903, "reg_write": 156, "sig_injection_runpe": 167, 
			"reg_access": 447, "sig_persistence_autorun": 315, "sig_reads_self": 558, "reg_delete": 60, "file_delete": 463, "sig_stealth_file": 204, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		]
      ];

	  var lockerData = [
		[
			{"file_access": 2086, "pe_imports": 625, "sig_clamav": 368, "pe_sec_character": 188, "sig_antivirus_virustotal": 1770, "cmd_exec": 234, "api_resolv": 570, 
			"pe_sec_entropy": 1971, "pe_sec_name": 316, "sig_packer_entropy": 425, "mutex_access": 213, "file_read": 1923, "sig_static_pe_anomaly": 21, 
			"sig_copies_self": 147, "sig_dropper": 146, "file_drop": 205, "file_write": 472, "str": 82, "reg_read": 801, "reg_write": 375, "sig_injection_runpe": 22, 
			"reg_access": 820, "sig_persistence_autorun": 151, "sig_reads_self": 692, "reg_delete": 61, "file_delete": 451, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 1278, "pe_imports": 638, "sig_clamav": 797, "pe_sec_character": 97, "sig_antivirus_virustotal": 398, "cmd_exec": 541, "api_resolv": 482, 
			"pe_sec_entropy": 1840, "pe_sec_name": 95, "sig_packer_entropy": 424, "mutex_access": 266, "file_read": 1126, "sig_static_pe_anomaly": 18, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 446, "str": 634, "reg_read": 180, "reg_write": 331, "sig_injection_runpe": 167, 
			"reg_access": 886, "sig_persistence_autorun": 69, "sig_reads_self": 673, "reg_delete": 58, "file_delete": 434, "sig_stealth_file": 150, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 1858, "pe_imports": 252, "sig_clamav": 560, "pe_sec_character": 108, "sig_antivirus_virustotal": 2018, "cmd_exec": 539, "api_resolv": 465, 
			"pe_sec_entropy": 615, "pe_sec_name": 118, "sig_packer_entropy": 557, "mutex_access": 343, "file_read": 1339, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 255, "file_write": 555, "str": 2290, "reg_read": 762, "reg_write": 222, "sig_injection_runpe": 167, 
			"reg_access": 1297, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 44, "file_delete": 455, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 131, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 2044, "pe_imports": 1417, "sig_clamav": 560, "pe_sec_character": 81, "sig_antivirus_virustotal": 2018, "cmd_exec": 403, "api_resolv": 761, 
			"pe_sec_entropy": 1181, "pe_sec_name": 211, "sig_packer_entropy": 557, "mutex_access": 213, "file_read": 1963, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 10, "file_drop": 475, "file_write": 102, "str": 1474, "reg_read": 924, "reg_write": 319, "sig_injection_runpe": 167, 
			"reg_access": 781, "sig_persistence_autorun": 68, "sig_reads_self": 136, "reg_delete": 56, "file_delete": 64, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 129, "net_dns": 91, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 1847, "pe_imports": 252, "sig_clamav": 560, "pe_sec_character": 123, "sig_antivirus_virustotal": 2123, "cmd_exec": 541, "api_resolv": 462, 
			"pe_sec_entropy": 1725, "pe_sec_name": 129, "sig_packer_entropy": 557, "mutex_access": 343, "file_read": 2, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 370, "file_write": 630, "str": 1539, "reg_read": 762, "reg_write": 331, 
			"sig_injection_runpe": 167, "reg_access": 1299, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 456, 
			"sig_stealth_file": 161, "sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		]
	  ];

	  var zeusData = [
		[
			{"file_access": 1129, "pe_imports": 1313, "sig_clamav": 560, "pe_sec_character": 140, "sig_antivirus_virustotal": 2018, "cmd_exec": 541, "api_resolv": 952, 
			"pe_sec_entropy": 262, "pe_sec_name": 211, "sig_packer_entropy": 606, "mutex_access": 266, "file_read": 989, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 311, "str": 1055, "reg_read": 482, "reg_write": 331, "sig_injection_runpe": 167, 
			"reg_access": 677, "sig_persistence_autorun": 69, "sig_reads_self": 402, "reg_delete": 58, "file_delete": 373, "sig_stealth_file": 105, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 1654, "pe_imports": 400, "sig_clamav": 338, "pe_sec_character": 39, "sig_antivirus_virustotal": 1389, "cmd_exec": 541, "api_resolv": 832, 
			"pe_sec_entropy": 1383, "pe_sec_name": 311, "sig_packer_entropy": 261, "mutex_access": 364, "file_read": 1479, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 599, "file_write": 526, "str": 2558, "reg_read": 425, "reg_write": 234, "sig_injection_runpe": 167, 
			"reg_access": 693, "sig_persistence_autorun": 57, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 500, "sig_stealth_file": 167, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 1846, "pe_imports": 1158, "sig_clamav": 560, "pe_sec_character": 68, "sig_antivirus_virustotal": 2616, "cmd_exec": 541, "api_resolv": 634, 
			"pe_sec_entropy": 1674, "pe_sec_name": 166, "sig_packer_entropy": 127, "mutex_access": 266, "file_read": 1776, "sig_static_pe_anomaly": 24, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 493, "str": 629, "reg_read": 655, "reg_write": 331, "sig_injection_runpe": 167, 
			"reg_access": 481, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 456, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 1061, "pe_imports": 530, "sig_clamav": 560, "pe_sec_character": 32, "sig_antivirus_virustotal": 2018, "cmd_exec": 541, "api_resolv": 938, 
			"pe_sec_entropy": 490, "pe_sec_name": 179, "sig_packer_entropy": 259, "mutex_access": 266, "file_read": 925, "sig_static_pe_anomaly": 24, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 493, "str": 979, "reg_read": 401, "reg_write": 331, "sig_injection_runpe": 258, 
			"reg_access": 680, "sig_persistence_autorun": 69, "sig_reads_self": 679, "reg_delete": 58, "file_delete": 456, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 2085, "pe_imports": 1139, "sig_clamav": 426, "pe_sec_character": 77, "sig_antivirus_virustotal": 466, "cmd_exec": 541, "api_resolv": 699, 
			"pe_sec_entropy": 477, "pe_sec_name": 207, "sig_packer_entropy": 557, "mutex_access": 266, "file_read": 1992, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 85, "file_write": 359, "str": 2255, "reg_read": 455, "reg_write": 489, "sig_injection_runpe": 167, 
			"reg_access": 703, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 456, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		]
	  ];

	  var shadowbrokersData = [
		[
			{"file_access": 500, "pe_imports": 600, "sig_clamav": 560, "pe_sec_character": 107, "sig_antivirus_virustotal": 980, "cmd_exec": 541, "api_resolv": 1051, 
			"pe_sec_entropy": 179, "pe_sec_name": 233, "sig_packer_entropy": 557, "mutex_access": 126, "file_read": 403, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 493, "str": 2074, "reg_read": 322, "reg_write": 331, "sig_injection_runpe": 167, 
			"reg_access": 1188, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 456, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 231}
		],
		[
			{"file_access": 1375, "pe_imports": 1539, "sig_clamav": 560, "pe_sec_character": 107, "sig_antivirus_virustotal": 2339, "cmd_exec": 541, "api_resolv": 634, 
			"pe_sec_entropy": 517, "pe_sec_name": 233, "sig_packer_entropy": 557, "mutex_access": 266, "file_read": 1222, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 493, "str": 2552, "reg_read": 126, "reg_write": 331, "sig_injection_runpe": 167, 
			"reg_access": 989, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 456, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 131}
		],
		[
			{"file_access": 1846, "pe_imports": 1671, "sig_clamav": 560, "pe_sec_character": 88, "sig_antivirus_virustotal": 2725, "cmd_exec": 541, "api_resolv": 634, 
			"pe_sec_entropy": 1314, "pe_sec_name": 214, "sig_packer_entropy": 557, "mutex_access": 266, "file_read": 1776, "sig_static_pe_anomaly": 24, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 493, "str": 1320, "reg_read": 655, "reg_write": 331, "sig_injection_runpe": 167, 
			"reg_access": 481, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 456, "sig_stealth_file": 161, 
			"sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 241}
		],
		[
			{"file_access": 1392, "pe_imports": 1211, "sig_clamav": 560, "pe_sec_character": 88, "sig_antivirus_virustotal": 319, "cmd_exec": 541, "api_resolv": 634, 
			"pe_sec_entropy": 2059, "pe_sec_name": 222, "sig_packer_entropy": 557, "mutex_access": 266, "file_read": 1240, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 493, "str": 1665, "reg_read": 134, "reg_write": 331, 
			"sig_injection_runpe": 167, "reg_access": 1192, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 456, 
			"sig_stealth_file": 161, "sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 111}
		],
		[
			{"file_access": 1177, "pe_imports": 759, "sig_clamav": 560, "pe_sec_character": 107, "sig_antivirus_virustotal": 80, "cmd_exec": 541, "api_resolv": 1003, 
			"pe_sec_entropy": 869, "pe_sec_name": 233, "sig_packer_entropy": 557, "mutex_access": 140, "file_read": 1037, "sig_static_pe_anomaly": 17, 
			"sig_copies_self": 147, "sig_dropper": 155, "file_drop": 685, "file_write": 493, "str": 1965, "reg_read": 317, "reg_write": 331, 
			"sig_injection_runpe": 167, "reg_access": 1176, "sig_persistence_autorun": 69, "sig_reads_self": 687, "reg_delete": 58, "file_delete": 456, 
			"sig_stealth_file": 161, "sig_antisandbox_sleep": 129, "net_dns": 95, "net_con": 53, "sig_static_detection": 187}
		]
	  ];

	  var randomSelectData = [
		{ data: apt1Data, dataType: "Apt1" },
		{ data: cryptoData, dataType: "Crypto" },
		{ data: lockerData, dataType: "Locker" },
		{ data: zeusData, dataType: "Zeus" },
		{ data: shadowbrokersData, dataType: "Shadowbrokers" }
	  ];

      // Function to enable/disable the preview button based on option selection
      function enablePreviewButton() {
        var dataType = document.getElementById("data-type").value;
        var previewButton = document.getElementById("preview-button");

        if (dataType !== "") {
          previewButton.disabled = false;
        } else {
          previewButton.disabled = true;
        }
      }

	  // Function to enable/disable the result button based on preview button click
      function enableResultButton() {
        var resultButton = document.getElementById("result-button");
        resultButton.disabled = !isPreviewed;
      }

      // Function to preview a random data from the selected data type
      function previewData() {
		var dataType = document.getElementById("data-type").value;
		var data;

		if (dataType === "Apt1") {
			data = apt1Data;
		} else if (dataType === "Crypto") {
			data = cryptoData;
		} else if (dataType === "Locker") {
			data = lockerData;
		} else if (dataType === "Zeus") {
			data = zeusData;
		} else if (dataType === "Shadowbrokers") {
			data = shadowbrokersData;
		} else if (dataType === "random") {
			var randomSelection = getRandomData(randomSelectData);
			data = randomSelection.data;
			dataType = randomSelection.dataType;
		}
		
		var randomIndex = Math.floor(Math.random() * data.length);
		var randomData = data[randomIndex];
		var beautifiedData = JSON.stringify(randomData, null, 2); // Indentation of 2 spaces

		document.getElementById("preview").innerHTML = beautifiedData;
		document.getElementById("data").value = beautifiedData;
		document.getElementById("selected-type").innerHTML = dataType;

		isPreviewed = true;
        enableResultButton();
      }

	  function getRandomData(data) {
		var randomIndex = Math.floor(Math.random() * data.length);
		return data[randomIndex];
	  }

	  // Function to submit the form and display the result
      function submitForm() {
        var form = document.getElementById("prediction-form");
        var data = new FormData(form);
        var xhr = new XMLHttpRequest();
        xhr.open("POST", "/prediction");
        xhr.onload = function() {
          if (xhr.status === 200) {
            var result = JSON.parse(xhr.responseText);
			var dataType = document.getElementById("selected-type").innerHTML;

			if (
				(dataType.includes("Apt1") && result["predictions"].includes(0)) ||
				(dataType.includes("Crypto") && result["predictions"].includes(1)) ||
				(dataType.includes("Locker") && result["predictions"].includes(2)) ||
				(dataType.includes("Zeus") && result["predictions"].includes(3)) ||
				(dataType.includes("Shadowbrokers") && result["predictions"].includes(4))
			) {
				document.getElementById("result").innerHTML =
				"Prediction: <span style='color: #2CA13A;'>True</span><br>" +
				result["message"];
			} else {
				document.getElementById("result").innerHTML =
				"Prediction: <span style='color: #E11403;'>False</span><br>" +
				result["message"];
			}
          } else {
            console.error(xhr.statusText);
          }
        };
        xhr.send(data);
      }

    </script>
  </head>
  <body>
	<table border="0" cellspacing="0" cellpadding="0" style="width: 1050px; margin: auto;">
		<tbody>
			<tr>
				<td><h1 style="color: #fff;">Malware Detection</h1></td>
			</tr>
			<tr>
				<td>
					<table border="0" cellspacing="0" cellpadding="0" style="width: 100%;">
						<tbody>
							<tr>
								<td style="width: 20%;" valign="top">
									<table border="0" cellspacing="0" cellpadding="0" style="width: 100%;">
										<tbody>
											<tr>
												<td style="background: #fff; padding: 10px; font-weight: 700;"><label for="data-type">Select Malware</label></td>
											</tr>
											<tr><td style="height: 10px;"></td></tr>
											<tr>
												<td class="select select--multiple" style="width: 30%;">
													<select id="data-type" onchange="enablePreviewButton()" multiple>
														<option value="Apt1">APT1</option>
														<option style="border-top: 1px solid #AAB7B8;" value="Crypto">Crypto</option>
														<option style="border-top: 1px solid #AAB7B8;" value="Locker">Locker</option>
														<option style="border-top: 1px solid #AAB7B8;" value="Zeus">Zeus</option>
														<option style="border-top: 1px solid #AAB7B8;" value="Shadowbrokers">ShadowBrokers</option>
														<option style="border-top: 1px solid #AAB7B8;" value="random">Random</option>
													</select>
												</td>
											</tr>
											<tr><td style="height: 10px;"></td></tr>
											<tr>
												<td><button id="preview-button" class="preview_button" onclick="previewData()" disabled>Preview Malware Data</button></td>
											</tr>
											<tr><td style="height: 10px;"></td></tr>
											<tr>
												<td>    
													<form id="prediction-form" style="margin: 0;" action="/prediction" method="POST" onsubmit="event.preventDefault(); submitForm();">
														<input type="hidden" id="data" name="data">
														<input type="submit" id="result-button" class="result_button" value="Scan for Malwares" disabled>
													</form>
												</td>
											</tr>
										</tbody>
									</table>
								</td>
								<td valign="top" style="padding-left: 10px;">
									<table border="0" cellspacing="0" cellpadding="0" style="width: 100%;">
										<tbody>
											<tr><td style="background: #fff; padding: 10px; font-weight: 700;">Label</td></tr>
											<tr><td style="height: 10px;"></td></tr>
											<tr>
												<td style="background: #F2F3F4; padding: 10px; height: 20px;"><div id="selected-type"></div></td>
											</tr>
											<tr><td style="height: 10px;"></td></tr>
											<tr><td style="background: #fff; padding: 10px; font-weight: 700;">Malware Data</td></tr>
											<tr><td style="height: 10px;"></td></tr>
											<tr>
												<td style="background: #F2F3F4; padding: 10px; height: 135px;"><div id="preview"></div></td>
											</tr>
											<tr><td style="height: 10px;"></td></tr>
											<tr><td style="background: #fff; padding: 10px; font-weight: 700;">Result of Scanning</td></tr>
											<tr><td style="height: 10px;"></td></tr>
											<tr>
												<td style="background: #F2F3F4; padding: 10px; height: 40px;"><div id="result"></div></td>
											</tr>
										</tbody>
									</table>
								</td>
							</tr>
						</tbody>
					</table>
				</td>
			</tr>
			
		</tbody>
	</table>
  </body>
</html>
