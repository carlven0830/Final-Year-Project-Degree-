import pandas as pd
import csv
import numpy as np 
from sklearn.model_selection import train_test_split
import lightgbm as lgb

# Read data into pandas dataframe
df = pd.read_csv("Dataset(BorutaUse2).csv")

# Separating the features from the target variable
X = df.iloc[:, 1:32]
y = df['label']

# Instantiate model
lgb_model = lgb.LGBMClassifier(bagging_fraction=0.5, boosting_type='dart', feature_fraction=0.5,
                               learning_rate=0.1, max_depth=7, num_leaves=30, random_state=0)

# Train the model on training data
lgb_model.fit(X, y)

#Serialize the model and save
import joblib

joblib.dump(lgb_model, 'lgbModel.pkl')
print("LightBGM Model Saved")

